@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<h3>Studenter</h3>

<form method="get">
    <input type="text" name="Sok" value="@Model.Sok" placeholder="Søk student..." />
    <button type="submit">Søk</button>
    <div class="dropdown">
        <label for="SelectedCourse">Sorter etter kurs:</label>
        <select id="SelectedCourse" name="SelectedCourse">
            <option value="">Velg kurs</option>
            @foreach (var c in Model.AllCourses)
            {
                <option value="@c.Coursecode" selected="@(c.Coursecode == Model.SelectedCourse ? "selected" : null)">
                    @c.Coursename (@c.Coursecode)
                </option>
            }
        </select>
        <button type="submit">Filtrer</button> 
    </div>
</form>

<ul>
    @foreach (var stud in Model.AllStudents)
    {
        <li>
            @stud.Studentname
            <ul>
                <li>Alder: @stud.Studentage</li>

                @if (!string.IsNullOrEmpty(Model.SelectedCourse))
                {
                    var selectedGrade = stud.Grades.FirstOrDefault(g => g.Coursecode == Model.SelectedCourse);
                    if (selectedGrade != null)
                    {
                        <li>@selectedGrade.Coursecode : @selectedGrade.Grade1</li>
                    }
                }
                else
                {
                    @foreach (var g in stud.Grades)
                    {
                        <li>@g.Coursecode : @g.Grade1</li>
                    }
                }
            </ul>
        </li>
    }
</ul>

